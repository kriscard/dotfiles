# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Terminal & Display
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

set -g default-terminal "${TERM}"
set -ga terminal-overrides ",xterm-ghostty:RGB:Tc"                              # true color
set -ga terminal-overrides ",xterm-ghostty:Ms=\\E]52;c;%p2%s\\7"                # OSC 52 clipboard
set -ga terminal-overrides ",xterm-ghostty:Smulx=\\E[4:3m"                      # undercurl
set -ga terminal-overrides ",xterm-ghostty:Setulc=\\E[58::2::%p1%d::%p2%d::%p3%dm"
set -g extended-keys on                                                         # modern keyboard (tmux 3.3+)
set -g allow-passthrough on                                                     # kitty image protocol

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# General Settings
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

set -g prefix C-a                                                               # ctrl-a (caps lock remapped)
bind C-a send-prefix                                                            # C-a C-a sends actual ctrl-a
set -g base-index 1                                                             # windows start at 1
set -g pane-base-index 1                                                        # panes start at 1
set -g renumber-windows on                                                      # renumber on close
set -g escape-time 0                                                            # no delay after escape
set -g history-limit 1000000                                                    # massive scrollback
set -g display-time 3000                                                        # messages visible 3s
set -g display-panes-time 2000                                                  # pane numbers visible 2s
set -g status-interval 3                                                        # status refresh 3s
set -g status-position top                                                      # macOS style
set -g detach-on-destroy off                                                    # switch session on close
set -g set-clipboard on
set -g focus-events on                                                          # for vim autoread
set -g mouse on                                                                 # mouse support (opt+click for links)

# Window behavior
set -g automatic-rename on
set -g automatic-rename-format "#{?#{==:#{pane_title},#{host}},#{pane_current_command},#{pane_title}}"
set -g set-titles on
set -g set-titles-string "#T - #W"
set -g monitor-activity off
set -g visual-activity off
set -g aggressive-resize off

# Vi mode
set -g mode-keys vi
set -g status-keys vi

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Key Bindings
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Basics
bind r source-file ~/.config/tmux/tmux.conf \; display "Config Reloaded!"
bind c new-window -c "#{pane_current_path}"                                     # keep cwd
bind x kill-pane                                                                # no confirm
bind Q confirm-before -p "Kill session #S? (y/n)" kill-session
bind D detach-client

# Navigation (vim style)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
bind -r p previous-window
bind -r n next-window
bind -r C-h select-window -t :-
bind -r C-l select-window -t :+

# Resize (shift + vim keys)
bind -r H resize-pane -L 10
bind -r J resize-pane -D 10
bind -r K resize-pane -U 10
bind -r L resize-pane -R 10

# Pane management
bind = select-layout tiled
bind M-j choose-window 'join-pane -h -s "%%"'                                   # join pane from window
bind M-b break-pane -d                                                          # break pane to window

# Copy mode (vi style)
bind Escape copy-mode
bind [ copy-mode
bind ] paste-buffer
bind p paste-buffer
bind -T copy-mode-vi v send -X begin-selection
bind y setw synchronize-panes                                                   # sync all panes

# Utilities
bind T set-option -g status                                                     # toggle status bar
bind C send-keys -R \; clear-history \; send-keys C-l                           # clear scrollback
bind W send-keys "tmux capture-pane -p -S - | nvim -c 'set buftype=nofile' +" Enter  # view in nvim
bind Y split-window -v -l 10 "npm run $(jq -r '.scripts | keys[]' package.json | fzf --no-border)"
bind g new-window -c "#{pane_current_path}" "sh -c 'gh dash'"                   # github dashboard
bind A split-window -h 'claude'                                                 # claude code

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Sesh (session management)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

bind e run-shell "sesh connect \"$(
  sesh list --icons | fzf-tmux -p 80%,70% \
    --no-sort --ansi --border-label ' sesh ' --prompt 'âš¡  ' \
    --header '  ^a all ^t tmux ^g configs ^x zoxide ^d tmux kill ^f find' \
    --bind 'tab:down,btab:up' \
    --bind 'ctrl-a:change-prompt(âš¡  )+reload(sesh list --icons)' \
    --bind 'ctrl-t:change-prompt(ğŸªŸ  )+reload(sesh list -t --icons)' \
    --bind 'ctrl-g:change-prompt(âš™ï¸  )+reload(sesh list -c --icons)' \
    --bind 'ctrl-x:change-prompt(ğŸ“  )+reload(sesh list -z --icons)' \
    --bind 'ctrl-f:change-prompt(ğŸ”  )+reload(fd -H -d 2 -t d -E .Trash . ~)' \
    --bind 'ctrl-d:execute(tmux kill-session -t {2..})+change-prompt(âš¡  )+reload(sesh list --icons)' \
    --preview-window 'right:55%' \
    --preview 'sesh preview {}'
)\""
bind E run-shell "sesh last"                                                    # last session
bind N display-popup -E "sesh ui"                                               # sesh ui popup
bind 9 run-shell "sesh connect --root '#{pane_current_path}'"                   # root session

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Theme
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

source-file "$DOTFILES/.config/tmux/themes/catppuccin/$THEME_FLAVOUR.conf"
source-file "$DOTFILES/.config/tmux/themes/catppuccin.conf"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Plugins
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'casonadams/tmux-vi-navigation'                                  # -, | split bindings
set -g @plugin 'christoomey/vim-tmux-navigator'                                 # ctrl+hjkl across vim/tmux
set -g @plugin 'tmux-plugins/tmux-resurrect'                                    # persist sessions
set -g @plugin 'tmux-plugins/tmux-continuum'                                    # auto save sessions
set -g @plugin 'tmux-plugins/tmux-yank'                                         # clipboard
set -g @plugin 'tmux-plugins/tmux-battery'                                      # battery status
set -g @plugin 'wfxr/tmux-fzf-url'                                              # open urls with fzf
set -g @plugin 'sainnhe/tmux-fzf'                                               # fzf for everything
set -g @plugin 'fcsonline/tmux-thumbs'                                          # quick copy hints
set -g @plugin 'kriscard/tmux-catppuccin'                                       # theme
set -g @plugin 'joshmedeski/tmux-nerd-font-window-name'                         # window icons
set -g @plugin 'rickstaa/tmux-notify'                                           # desktop notifications
set -g @plugin 'omerxx/tmux-floax'                                              # floating panes

# Plugin settings
set -g @fzf-url-bind 'o'
set -g @floax-bind 'F'
set -g @tnotify-verbose 'on'
set -g @tmux-nerd-font-window-name-show-name false
set -g @yank_selection 'clipboard'
set -g @yank_selection_mouse 'clipboard'
set -g @yank_with_mouse on
set -g @continuum-restore 'off'                                                 # using sesh instead

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# TPM (keep at bottom)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

set-environment -g TMUX_PLUGIN_MANAGER_PATH "$HOME/.config/tmux/plugins"
run "$HOME/.config/tmux/plugins/tpm/tpm"
